<div>
    Choose Any Date
    <div class='poll'>
    </div>
    <div>
        <div class='input-group date' id='datetimepicker1'>
            <input type='text' class="form-control" id='new_date' readonly/>
            <span class="input-group-addon">
                <span class="glyphicon glyphicon-calendar"></span>
            </span>
        </div>
        <button type='button' id='add_date'>+</button>
    </div>
</div>

<script>
    let count =0;
    let vote =[];
    $(function () {
        let date = $('#datetimepicker1').datetimepicker();
        $('#datetimepicker1').data("DateTimePicker").ignoreReadonly(true);
        
        $('#add_date').on('click',()=>{
            if($('#new_date').val() != ""){
                console.log($('#new_date').val());
                let row =(`<ul><input type="checkbox"  name='date_poll' class="date_poll" id ="${count}">
                            ${$('#new_date').val()} 
                            Vote:
                            <span class='vote_count'>${vote[$(this).attr('id')] || 0 }</span>
                            </ul>`);
                $('.poll').append(row)
                count++;
            }else{
                alert('Invalid date');
            }
        })
        $('#date_count_0').on('click',()=>{
            console.log('clicked');
            if($('#date_count_0').prop('checked')==true){
                vote[0] += 1;
            }else if($('#date_count_0').prop('checked') == false){
                vote[0] -= 1;
            }
        })
        $('.poll').on('click','.date_poll', function(){
            let current_id=$(this).attr('id');
            if(isNaN(vote[current_id]) == true){
                vote[current_id] =0;
            }
            if($(this).prop('checked')==true){
                vote[current_id] += 1;
            }else if($(this).prop('checked') == false){
                vote[current_id] -= 1;
            }
            $(this).parent().children('.vote_count').html(vote[current_id])
        })

    });
    //vote=['2','5','2',]
</script>

